<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grocery Categories</title>
    <style>
        body { font-family: Arial, sans-serif; background:#f8f8f8; margin:0; padding:0; display:flex; justify-content:center; }
        .container { max-width:400px; width:100%; background:white; height:100vh; overflow:hidden; display:flex; flex-direction:column; box-shadow:0 0 15px rgba(0,0,0,0.1); }
        header { background:white; padding:15px; text-align:center; border-bottom:1px solid #eee; }
        header h1 { margin:0; font-size:24px; color:#333; }
        .tabs { display:flex; background:#f0f8f0; padding:10px; border-bottom:1px solid #ddd; }
        .tab { flex:1; text-align:center; padding:8px; font-weight:bold; }
        .tab.active { color:#4CAF50; border-bottom:3px solid #4CAF50; }
        .grid { display:grid; grid-template-columns:repeat(3,1fr); gap:15px; padding:20px; flex-grow:1; overflow-y:auto; }
        .category { text-align:center; cursor:pointer; transition:0.3s; }
        .category:hover { transform:scale(1.05); }
        .category img { width:100%; height:120px; object-fit:cover; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
        .category p { margin:10px 0 0; font-size:14px; color:#333; font-weight:500; }
        .loading { text-align:center; padding:40px; color:#666; }
    </style>
</head>
<body>
    <div class="container">
        <header><h1>CATEGORIES</h1></header>
        <div class="tabs">
            <div class="tab active">All</div>
            <div class="tab">Popular</div>
        </div>
        <div class="grid" id="categoryGrid">
            <div class="loading">Loading categories...</div>
        </div>
    </div>

    <script>
        // Default category images (you can enhance this later with per-category images)
        const categoryImages = {
            "Fruits & Vegetables": "https://thumbs.dreamstime.com/b/fresh-vegetables-sale-indian-street-market-assorted-261843812.jpg",
            "Dairy, Bread & Eggs": "https://nagabazaar.com/cdn/shop/collections/towfiqu-barbhuiya-X4zRlInfdQg-unsplash-300x300.webp?v=1748116760",
            "Atta, Rice, Oils & Dals": "https://m.media-amazon.com/images/I/81qmtmMSHoL._AC_UF894,1000_QL80_.jpg",
            "Masala & Dry Fruits": "https://snnfoods.com/cdn/shop/articles/snn-blog-1-image-151086.jpg?v=1710844801",
            "Rice": "https://media.gettyimages.com/id/1157969278/photo/various-brands-of-basmati-rice-bags-for-sale.jpg?s=612x612&w=gi&k=20&c=o5oZ7JKpSflYaqxBxwTipBpUSsF1GYbIFE-wCjriVBc=",
            "Snacks & Chocolates": "https://m.media-amazon.com/images/I/61Jwn55lp4L._AC_UF894,1000_QL80_.jpg",
            "Beverages": "https://www.tastingtable.com/img/gallery/21-indian-drinks-you-need-to-try-at-least-once/l-intro-1718799368.jpg",
            "Cleaning & Household": "https://5.imimg.com/data5/SELLER/Default/2022/10/NK/DL/UX/1651149/household-cleaning-products-formulation-consulting.jpeg"
        };

        async function loadCategories() {
            try {
                const res = await fetch("/api/categories");
                const data = await res.json();
                const grid = document.getElementById("categoryGrid");

                if (data.success && data.categories.length > 0) {
                    grid.innerHTML = data.categories.map(cat => {
                        const img = categoryImages[cat] || "https://via.placeholder.com/300x120?text=" + encodeURIComponent(cat);
                        return `
                            <div class="category" onclick="openCategory('${cat.replace(/'/g, "\\'")}')">
                                <img src="${img}" alt="${cat}">
                                <p>${cat}</p>
                            </div>
                        `;
                    }).join("");
                } else {
                    grid.innerHTML = "<div class='loading'>No categories yet. Add items in Admin Portal!</div>";
                }
            } catch (err) {
                document.getElementById("categoryGrid").innerHTML = "<div class='loading'>Error loading categories</div>";
            }
        }

        function openCategory(name) {
            localStorage.setItem('selectedCategory', name);
            window.location.href = 'gitems.html';
        }

        window.onload = loadCategories;
    </script>
</body>
</html>
