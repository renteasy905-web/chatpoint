<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Items | Chat Point</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <style>
    :root {
      --primary:#2c4d51;
      --accent:#fb641b;
      --success:#388e3c;
      --bg:#fad075;
      --card-bg:#0e404c;
      --text-primary:#e48e2b;
      --text-secondary:#edf5f8;
      --border:rgba(0,0,0,.08);
      --shadow-sm:0 2px 4px rgba(0,0,0,.08);
      --shadow-md:0 4px 12px rgba(0,0,0,.1);
      --shadow-lg:0 12px 28px rgba(0,0,0,.12);
      --radius:8px;
      --transition:.3s cubic-bezier(.4,0,.2,1);
    }

    * { box-sizing:border-box; margin:0; padding:0; }
    body {
      font-family:Roboto,system-ui,sans-serif;
      background:var(--bg);
      color:var(--text-primary);
      padding-bottom:90px;
    }

    /* Header */
    header {
      position:sticky;
      top:0;
      z-index:100;
      background:var(--primary);
      color:#fff;
      padding:12px 16px;
      display:flex;
      align-items:center;
      box-shadow:var(--shadow-md);
    }
    .back-btn {
      width:40px;height:40px;
      border-radius:50%;
      border:none;
      background:rgba(255,255,255,.2);
      color:#fff;
      cursor:pointer;
      display:grid;
      place-items:center;
      transition:var(--transition);
    }
    .back-btn:hover { background:rgba(255,255,255,.3); }
    .header-content { flex:1; margin-left:12px; }
    .brand-title { font-weight:900; font-size:20px; }
    .brand-title span { color:#ffe500; }
    .location { font-size:12px; opacity:.9; }
    .shop-name { font-weight:700; font-size:16px; }

    main {
      max-width:1200px;
      margin:16px auto;
      padding:0 12px;
    }

    /* New: Quote Section - Optimized position above items */
    .quote-section {
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(8px);
      border-radius: var(--radius);
      padding: 20px;
      margin: 0 0 24px 0;
      text-align: center;
      box-shadow: var(--shadow-sm);
      font-style: italic;
    }
    .quote {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    .quote-author {
      font-size: 14px;
      color: var(--text-secondary);
      opacity: 0.9;
    }
    .quick-tip {
      font-size: 16px;
      font-weight: 700;
      color: var(--accent);
      margin-bottom: 12px;
    }

    .login-banner {
      background:#fff;
      padding:16px;
      border-radius:var(--radius);
      box-shadow:var(--shadow-sm);
      text-align:center;
      font-weight:500;
      margin-bottom:16px;
    }

    /* Grid */
    .items-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:16px;
    }

    .item-card {
      background:var(--card-bg);
      border-radius:var(--radius);
      overflow:hidden;
      border:1px solid var(--border);
      box-shadow:var(--shadow-sm);
      transition:transform .4s cubic-bezier(.2,.8,.4,1), box-shadow var(--transition);
      touch-action:pan-y;
      position:relative;
    }

    /* Hover: Small tilting effect */
    .item-card:hover {
      transform: translateY(-6px) perspective(1000px) rotateX(4deg);
      box-shadow:var(--shadow-lg);
    }

    /* Swipe feedback classes */
    .item-card.swiping-right {
      transform: translateX(20px) scale(1.02);
      box-shadow:0 0 0 3px var(--success), var(--shadow-lg);
    }
    .item-card.swiping-left {
      transform: translateX(-20px) scale(1.02);
      box-shadow:0 0 0 3px #d32f2f, var(--shadow-lg);
    }
    .item-card.added {
      animation: addPulse 0.6s ease-out;
    }
    .item-card.removed {
      animation: removePulse 0.6s ease-out;
    }

    @keyframes addPulse {
      0% { transform:scale(1); }
      50% { transform:scale(1.05); box-shadow:0 0 0 8px rgba(56,142,60,0.4); }
      100% { transform:scale(1); }
    }
    @keyframes removePulse {
      0% { transform:scale(1); }
      50% { transform:scale(1.05); box-shadow:0 0 0 8px rgba(211,47,47,0.4); }
      100% { transform:scale(1); }
    }

    /* + Icon overlay on swipe right */
    .swipe-plus {
      position:absolute;
      top:50%;
      left:50%;
      transform:translate(-50%,-50%);
      font-size:80px;
      color:var(--success);
      opacity:0;
      pointer-events:none;
      transition:opacity 0.2s;
      z-index:10;
    }
    .item-card.swiping-right .swipe-plus {
      opacity:0.7;
    }

    .item-img {
      width:100%;
      height:180px;
      object-fit:cover;
      background:#f8f8f8;
    }

    .item-info {
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:8px;
    }

    .item-name {
      font-size:15px;
      font-weight:500;
      line-height:1.4;
      display:-webkit-box;
      -webkit-line-clamp:2;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }

    .item-desc {
      font-size:13px;
      color:var(--text-secondary);
    }

    .price-container {
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }

    .new-price { font-size:20px; font-weight:800; }
    .old-price {
      font-size:14px;
      color:#9e9e9e;
      text-decoration:line-through;
    }

    .discount-badge {
      background:linear-gradient(135deg,#1b5e20,#43a047);
      color:#fff;
      font-size:11px;
      font-weight:800;
      padding:4px 8px;
      border-radius:6px;
    }

    .quantity {
      display:flex;
      align-items:center;
      gap:12px;
      margin-top:10px;
    }

    .qbtn {
      width:36px;height:36px;
      border-radius:50%;
      border:1px solid var(--border);
      background:#fff;
      color:var(--primary);
      font-size:18px;
      font-weight:700;
      cursor:pointer;
      transition:var(--transition);
    }

    .qbtn:hover {
      background:var(--primary);
      color:#fff;
      transform:scale(1.1);
    }

    .qty {
      min-width:24px;
      text-align:center;
      font-weight:700;
    }

    .cart-bar {
      position:fixed;
      bottom:16px;
      left:50%;
      transform:translateX(-50%);
      width:calc(100% - 32px);
      max-width:400px;
      background:#fff;
      border-radius:var(--radius);
      border:1px solid var(--border);
      box-shadow:var(--shadow-lg);
      padding:12px 16px;
      display:none;
      align-items:center;
      justify-content:space-between;
      cursor:pointer;
      z-index:100;
    }

    .checkout-btn {
      background: var(--success);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: var(--radius);
      font-weight: 700;
      cursor: pointer;
    }

    @media (max-width:480px) {
      .item-img { height:160px; }
      .items-grid { grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); }
      .quote-section { padding:16px; }
      .quote { font-size:16px; }
    }
  </style>
</head>

<body>

<header>
  <button class="back-btn" id="backBtn"><i class="fas fa-arrow-left"></i></button>
  <div class="header-content">
    <div class="brand-title">Chat<span>Point</span></div>
    <div class="location">Sindagi • Food Delivery</div>
  </div>
  <div class="shop-name" id="shopName"></div>
</header>

<main>
 

  <div id="loginBanner" class="login-banner" hidden>
    Please <a href="login.html">login</a> to add items to cart.
  </div>
  <div style="padding: 5px; display: flex; flex-direction: column; align-items: center; border: 1px; background-color: rgb(233, 237, 235); margin-bottom: 25px; color: white; border-radius: 8px; " >
    <span style="text-align: center; color: rgb(240, 42, 16); font:bolder; font-size: large;">Quick Tip: </span>
   <span style="color: rgb(16, 1, 1); font-weight: bolder; font-size: 18px;"> Swipe right on a card to add to cart! </span>
  </div>
  
  <section class="items-grid" id="itemsGrid"></section>
</main>

<div class="cart-bar" id="cartBar">
  <div>
    <div id="cartText"></div>
    <small>Tap to view cart</small>
  </div>
  <button class="checkout-btn">Checkout</button>
</div>
 <div style="padding: 10px; display: flex; flex-direction: column; align-items: center; border: 1px; background-color: rgb(233, 237, 235); margin-bottom: 25px; color: white; border-radius: 8px; " >
    <span style="text-align: center; color: rgb(12, 12, 12); font:bolder; font-size: large;">"People who love to eat are always the best people."</span>
   <span style="color: rgb(220, 182, 16); font-weight: bolder; font-size: 18px;"> Julia Child</span>
  </div>

<script>
(() => {
  const DISCOUNT = 5;
  const SWIPE_THRESHOLD = 50;

  const els = {
    grid: document.getElementById("itemsGrid"),
    cartBar: document.getElementById("cartBar"),
    cartText: document.getElementById("cartText"),
    shopName: document.getElementById("shopName"),
    loginBanner: document.getElementById("loginBanner")
  };

  const user = JSON.parse(localStorage.getItem("chatpoint_user") || "null");
  const isLoggedIn = !!(user && user._id);
  if (!isLoggedIn) els.loginBanner.hidden = false;

  const shopData = {
    "Chat Point": [
      { name:"Akoo tikki burger + onion pizza + cheese sandwich + fry momos", price:300, image:"https://images.unsplash.com/photo-1724041307393-d5cdd2f4ebb8?q=80&w=1340&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" },
      { name:"Veg roll + paneer puff + veg sandwich + Paneer burger + 750ml water", price:229, image:"https://images.unsplash.com/photo-1646715574223-3ddce03d3a24?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDE0fHx8ZW58MHx8fHx8" },
      { name:"Veggie pizza + French fries + Coca Cola 250ml", price:279, image:"https://plus.unsplash.com/premium_photo-1726711243837-48483c71b7df?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDIwfHx8ZW58MHx8fHx8" },
      { name:"Jeera Rice", price:159, image:"https://images.unsplash.com/photo-1576866206930-9c7e5fe27e3e?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1yZWxhdGVkfDE4fHx8ZW58MHx8fHx8" },
      { name:"Veg Biryani + 750ml water", price:189, image:"https://plus.unsplash.com/premium_photo-1694141252026-3df1de888a21?q=80&w=1169&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" }
    ]
    // Add other shops as needed
  };

  const params = new URLSearchParams(location.search);
  const shopName = decodeURIComponent(params.get("shop") || "").trim();
  const items = shopData[shopName] || [];
  els.shopName.textContent = shopName || "Shop";

  let cart = JSON.parse(localStorage.getItem("chatpoint_cart") || "{}");

  function saveCart() {
    localStorage.setItem("chatpoint_cart", JSON.stringify(cart));
    updateCart();
  }

  function updateCart() {
    let qty = 0, total = 0;
    Object.values(cart).forEach(s =>
      Object.values(s).forEach(i => {
        qty += i.qty;
        total += i.qty * i.price;
      })
    );
    els.cartText.textContent = `${qty} items · ₹${total}`;
    els.cartBar.style.display = qty ? "flex" : "none";
  }

  window.changeQty = (shop, name, price, delta) => {
    if (!isLoggedIn) return alert("Please login first!");
    cart[shop] ??= {};
    cart[shop][name] ??= { qty:0, price:price - DISCOUNT };
    cart[shop][name].qty = Math.max(0, cart[shop][name].qty + delta);
    if (!cart[shop][name].qty) delete cart[shop][name];
    if (!Object.keys(cart[shop]).length) delete cart[shop];
    saveCart();
    render();
  };

  function attachSwipe(card, item) {
    let startX = 0;
    let currentX = 0;

    const plusIcon = document.createElement("div");
    plusIcon.className = "swipe-plus";
    plusIcon.innerHTML = `<i class="fas fa-plus"></i>`;
    card.appendChild(plusIcon);

    card.addEventListener("touchstart", e => {
      startX = e.touches[0].clientX;
      card.classList.remove("swiping-right", "swiping-left", "added", "removed");
    }, { passive: true });

    card.addEventListener("touchmove", e => {
      currentX = e.touches[0].clientX;
      const diff = currentX - startX;

      card.classList.remove("swiping-right", "swiping-left");

      if (diff > 15) {
        card.classList.add("swiping-right");
      } else if (diff < -15) {
        card.classList.add("swiping-left");
      }
    }, { passive: true });

    card.addEventListener("touchend", () => {
      const diff = currentX - startX;

      if (Math.abs(diff) > SWIPE_THRESHOLD) {
        if (diff > 0) {
          changeQty(shopName, item.name, item.price, 1);
          card.classList.add("added");
        } else {
          const currentQty = cart[shopName]?.[item.name]?.qty || 0;
          if (currentQty > 0) {
            changeQty(shopName, item.name, item.price, -1);
            card.classList.add("removed");
          }
        }
      }

      setTimeout(() => {
        card.classList.remove("swiping-right", "swiping-left", "added", "removed");
      }, 300);
    });
  }

  function render() {
    els.grid.innerHTML = "";
    items.forEach(item => {
      const qty = cart[shopName]?.[item.name]?.qty || 0;
      const card = document.createElement("article");
      card.className = "item-card";
      card.innerHTML = `
        <img class="item-img" src="${item.image}" alt="${item.name}">
        <div class="item-info">
          <div class="item-name">${item.name}</div>
          <div class="item-desc">Fresh & Tasty</div>
          <div class="price-container">
            <div class="new-price">₹${item.price - DISCOUNT}</div>
            <div class="old-price">₹${item.price}</div>
            <div class="discount-badge">SAVE ₹5</div>
          </div>
          <div class="quantity">
            <button class="qbtn" onclick="changeQty('${shopName}','${item.name}',${item.price},-1)">−</button>
            <div class="qty">${qty}</div>
            <button class="qbtn" onclick="changeQty('${shopName}','${item.name}',${item.price},1)">+</button>
          </div>
        </div>`;
      attachSwipe(card, item);
      els.grid.appendChild(card);
    });
  }

  render();
  updateCart();

  document.getElementById("backBtn").onclick = () => history.back();
  els.cartBar.onclick = () => location.href = "cart.html";
})();
</script>

</body>
</html>
      document.getElementById("cartBar").style.display = items > 0 ? "flex" : "none";
    }

    function changeQty(shop, name, originalPrice, delta) {
      if (!isLoggedIn) return alert("Please login first!");
      if (!cart[shop]) cart[shop] = {};
      if (!cart[shop][name]) {
        cart[shop][name] = { qty: 0, price: originalPrice - DISCOUNT };
      }
      cart[shop][name].qty = Math.max(0, cart[shop][name].qty + delta);
      if (cart[shop][name].qty === 0) delete cart[shop][name];
      if (Object.keys(cart[shop]).length === 0) delete cart[shop];
      saveCart();
      renderItems();
    }

    function renderItems() {
      const grid = document.getElementById("itemsGrid");
      grid.innerHTML = "";
      shopItems.forEach(item => {
        const originalPrice = item.price;
        const discountedPrice = originalPrice - DISCOUNT;
        const qty = (cart[shopName] && cart[shopName][item.name]) ? cart[shopName][item.name].qty : 0;
        const card = document.createElement("article");
        card.className = "item-card";
        card.innerHTML = `
          <img src="images/${item.image}" alt="${item.name}" class="item-img" loading="lazy"
               onerror="this.src='https://via.placeholder.com/600x380/f3cd98/f12916?text=${encodeURIComponent(item.name.split(' ').slice(0,3).join(' '))}'">
          <div class="item-info">
            <div class="item-name">${item.name}</div>
            <div class="item-desc">${item.name.toLowerCase().includes("cake") ? "Fresh Cream • Per kg" : "Homemade Special"}</div>
            <div class="price-container">
              <div class="old-price">₹${originalPrice}</div>
              <div class="new-price">₹${discountedPrice}</div>
              <div class="discount-badge">-₹5 OFF</div>
            </div>
            <div class="quantity">
              <button class="qbtn" onclick="changeQty('${shopName}','${item.name.replace(/'/g, "\\'")}',${originalPrice},-1)">−</button>
              <div class="qty">${qty}</div>
              <button class="qbtn" onclick="changeQty('${shopName}','${item.name.replace(/'/g, "\\'")}',${originalPrice},1)">+</button>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    // Set shop name in header
    document.getElementById("shopName").textContent = shopName || "Shop Not Found";

    // Render items if found
    if (shopItems.length) {
      renderItems();
    } else {
      document.getElementById("itemsGrid").innerHTML = "<p style='text-align:center;grid-column:1/-1;font-size:1.2rem;color:#666;'>No items found for this shop.</p>";
    }

    updateCartBar();

    document.getElementById("backBtn").onclick = () => history.back();
    document.getElementById("cartBar").onclick = () => location.href = "cart.html";
    document.getElementById("checkoutBtn").onclick = e => { e.stopPropagation(); location.href = "cart.html"; };
  </script>
</body>
</html>
